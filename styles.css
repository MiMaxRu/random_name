/* ===== ТЕМИ =================================================== */
:root{
  --bg:  linear-gradient(135deg,#0b1224 0%, #151e34 40%, #3b82f6 100%);
  --logo-fg: #ffffff;
  --logo-accent: #E61E3A;
  --logo-muted: rgba(255,255,255,.92);
  --logo-surface: rgba(255,255,255,.06);
  --panel: rgba(255,255,255,.08);
  --glass: rgba(255,255,255,.14);
  --text: #eaf0ff;
  --muted:#b9c3d9;
  --border: rgba(255,255,255,.14);
  --accent1:#22c55e; --accent2:#16a34a;
  --chip1:#f59e0b; --chip2:#ef4444;
  --shadow: 0 8px 30px rgba(2,10,30,.35);
}
:root[data-theme="light"]{
  --bg:  linear-gradient(135deg,#e7efff 0%, #f4f7ff 50%, #e5f0ff 100%);
  --logo-fg: #0f172a;
  --logo-accent: #E61E3A;
  --logo-muted: rgba(15,23,42,.92);
  --logo-surface: rgba(0,0,0,.06);
  --panel: rgba(255,255,255,.8);
  --glass: rgba(0,0,0,.05);
  --text:#0f172a;
  --muted:#475569;
  --border: rgba(0,0,0,.08);
  --accent1:#0ea5e9; --accent2:#0284c7;
  --chip1:#fb923c; --chip2:#f43f5e;
  --shadow: 0 8px 24px rgba(10,26,60,.15);
}

/* ===== БАЗА =================================================== */
*{ box-sizing:border-box }
html,
body{
  margin:0; color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:var(--bg);
  min-height:100svh; min-height:100dvh;
}
.topbar{
  position:sticky; top:0; z-index:10;
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 14px; backdrop-filter:blur(10px);
}
.brand{ display:flex; align-items:center; gap:8px; font-weight:800; letter-spacing:.2px }
.logo-wrap{
  display:inline-flex; align-items:center; gap:8px;
  background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
  border:1px solid var(--border); padding:6px 10px; border-radius:8px;
  box-shadow: 0 6px 18px rgba(0,0,0,0.06);
  position:relative;
}
.logo-wrap::before{
  content:''; position:absolute; left:0; top:0; bottom:0; width:4px;
  background: linear-gradient(180deg, var(--logo-accent), rgba(255,255,255,0.15)); border-top-left-radius:8px; border-bottom-left-radius:8px;
}
.logo-wrap img{ height:36px; width:auto; display:block; object-fit:contain; border-radius:0 }
.center-logo{ position:absolute; left:50%; transform:translateX(-50%); }
.logo-wrap{ max-height:48px }

@media (max-width: 520px){
  .center-logo{ position:static; transform:none; display:inline-block; margin:0 auto; }
  .topbar{ padding:10px; }
}

/* Стили для inline SVG логотипа: используем классы fg/accent/muted/word/small внутри SVG */
.logo .fg{ fill: var(--logo-fg) }
.logo .accent{ fill: var(--logo-accent) }
.logo .muted{ fill: var(--logo-muted) }
.logo .word{ font: 800 28px/1 "Poppins", "Montserrat", "Segoe UI", Arial, sans-serif; letter-spacing: .5px }
.logo .small{ font: 700 11px/1 "Poppins", "Montserrat", "Segoe UI", Arial, sans-serif; letter-spacing: 1px }
.center-logo{ position:absolute; left:50%; transform:translateX(-50%); height:40px }
.badge{ width:28px; height:28px; display:grid; place-items:center; border-radius:10px; background:linear-gradient(135deg,#a78bfa,#60a5fa); box-shadow: 0 6px 16px rgba(80,120,255,.4) }
.brand-text{ line-height:1; font-size:16px }
.select{ width:100%; margin-top:6px; padding:10px 12px; border-radius:10px; background:rgba(255,255,255,.03); border:1px solid var(--border); color:inherit }
.icon-btn{
  border:none; background:transparent; font-size:20px; cursor:pointer;
  border-radius:12px; padding:8px 10px; line-height:1;
  transition: transform .08s ease, background-color .2s ease;
}
.icon-btn:active{ transform:scale(.96) }
.icon-btn:hover{ background:var(--panel) }

.app{
  max-width: 980px; margin: 0 auto; padding: 16px;
  display:grid; gap:16px;
}
.title{ margin:6px 0 0; text-align:center; font-size:28px }
.grad{
  background: linear-gradient(90deg,#60a5fa, #a78bfa, #22d3ee);
  -webkit-background-clip: text; background-clip: text; color: transparent;
}
.sub{ text-align:center; opacity:.85; margin: -4px 0 2px; font-size:14px }

.grid{
  display:grid; grid-template-columns: 1fr; gap:14px;
}
@media (min-width: 860px){
  .grid{ grid-template-columns: 1fr 1fr; }
}

.panel{
  background:var(--panel); border:1px solid var(--border);
  border-radius:16px; padding:16px; backdrop-filter: blur(12px);
  box-shadow: var(--shadow);
}

textarea{
  width:100%;
  min-height:120px;
  max-height:45svh; /* стабільно на iPhone */
  resize:vertical; overflow-y:auto;
  background:rgba(255,255,255,.04);
  color:inherit; border:1px solid var(--border); border-radius:12px;
  padding:12px; line-height:1.35; font-size:16px; /* 16px — без зуму */
}
@media (max-height: 700px){
  textarea{ max-height: 38svh; }
}

.row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:10px; }
.row.second{ margin-top:8px }

.btn{
  position:relative; isolation:isolate;
  appearance:none; border:1px solid var(--border); cursor:pointer;
  border-radius:12px; padding:12px 16px; font-weight:700; font-size:16px;
  background: rgba(255,255,255,.04); color:inherit;
  transition: transform .08s ease, filter .2s ease, box-shadow .2s ease, background .2s ease;
  overflow:hidden;
}
.fullwidth{ width: calc(100% - 8px); display:block; margin:0 auto; padding-left:16px; padding-right:16px }
.btn:hover{ filter:brightness(1.05) }
.btn:active{ transform: translateY(1px) scale(.99) }

.btn.primary{
  background: linear-gradient(135deg,var(--accent1),var(--accent2));
  color:#fff; border-color:transparent; box-shadow: 0 8px 18px rgba(20,160,120,.35);
}
.btn.ghost{ background:transparent; border:1px dashed var(--border) }
.btn.soft{
  background: rgba(255,255,255,.06);
}
.btn[disabled]{ filter:grayscale(1) brightness(.9); cursor:not-allowed; opacity:.8 }

.btn .ripple{
  position:absolute; border-radius:50%;
  transform:translate(-50%, -50%); pointer-events:none; aspect-ratio: 1 / 1;
  animation:ripple .6s ease-out forwards;
  background: radial-gradient(circle, rgba(255,255,255,.45), rgba(255,255,255,0) 60%);
}
@keyframes ripple{
  from{ width:0; opacity:.8 }
  to{ width:220%; opacity:0 }
}

.note{ font-size:12px; opacity:.85 }
.note.small{ opacity:.75; }

.slots{
  display:grid; gap:10px; grid-template-columns:1fr;
  margin-top:8px;
}
@media (min-width:600px){ .slots{ grid-template-columns: repeat(3, 1fr); } }

.slot{
  position:relative; overflow:hidden;
  background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.04));
  border:1px solid var(--border); border-radius:14px; height:88px;
  display:flex; align-items:center; justify-content:center;
  font-size:22px; font-weight:800; letter-spacing:.3px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.12);
  perspective: 800px;
}
.slot::after{
  content:""; position:absolute; inset:0;
  background: radial-gradient(120px 40px at 20% 0%, rgba(255,255,255,.2), transparent 50%);
  opacity:.6; pointer-events:none;
}
.slot span{ display:block; transform:translateY(0); transition: transform .25s ease }
.slot.spin span{ animation: spin 900ms linear infinite }
@keyframes spin{
  0%{ transform: translateY(0) rotateX(0deg) }
  100%{ transform: translateY(-110%) rotateX(20deg) }
}

.winners-wrap{ min-height:42px; }
.winners{ display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; }
.chip{
    width: 100%;
  display:inline-flex; align-items:center; gap:8px;
  background:linear-gradient(135deg,var(--chip1),var(--chip2));
  color:white; padding:10px 14px; border-radius:12px; font-weight:800; font-size:15px;
  box-shadow: 0 8px 18px rgba(20,100,80,.18);
  transform: translateY(6px); opacity:1; /* тепер відображаємо одразу */
  max-width: 100%;
}

.robot-wrap{ display:flex; justify-content:center; margin-top:12px }
.robot-wrap img{ width:120px; max-width:40%; border-radius:12px; box-shadow: 0 10px 30px rgba(2,10,30,.2) }

/* Стилі для динамічних слотів-переможців */
.slot.multiple{ height:68px; font-size:16px }
.slot .label-prize{ display:block; font-size:12px; opacity:.85; margin-top:6px; font-weight:600; max-width:100%;
  overflow:hidden; white-space:nowrap; text-overflow:ellipsis }

.small-note{ font-size:13px; opacity:.85 }

/* Модальне вікно результатів */
.modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:60 }
.modal[aria-hidden="false"]{ display:flex }
.modal-overlay{ position:absolute; inset:0; background:rgba(2,6,23,.6); backdrop-filter: blur(6px) }
.modal-content{ position:relative; max-width:920px; width:96%; margin:auto; border-radius:14px; overflow:hidden }
.modal-body{ display:flex; gap:18px; align-items:stretch; background:var(--panel); padding:18px; border:1px solid var(--border); border-radius:12px }
.modal-content::before{
  content:""; position:absolute; inset:0; pointer-events:none;
  background-image: url('robot.png');
  background-repeat:no-repeat; background-position:right center; background-size:40%; opacity:0.06;
}
.modal-robot{ flex:0 0 160px; display:flex; align-items:center; justify-content:center }
.modal-robot img{ width:140px; filter: drop-shadow(0 10px 30px rgba(2,10,30,.2)); }
.modal-results{ flex:1 }
.modal-winners{ display:flex; flex-direction:column; gap:10px; margin-top:8px }
.winner-card{ display:flex; align-items:center; gap:12px; padding:12px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01)); border:1px solid var(--border) }
.winner-rank{ font-weight:900; font-size:18px; width:40px; text-align:center }
.winner-name{ font-size:16px; font-weight:800 }
.winner-prize{ font-size:13px; opacity:.9; margin-left:auto; background:rgba(255,255,255,.04); padding:6px 10px; border-radius:10px; max-width:36ch; overflow:hidden; white-space:nowrap; text-overflow:ellipsis; }
.modal-actions{ margin-top:12px; display:flex; gap:8px }
.modal-close{ position:absolute; right:10px; top:8px; background:transparent; border:none; font-size:18px; cursor:pointer }

/* Стиль для призу всередині .chip */
.chip-prize{ margin-left:8px; font-size:13px; opacity:.95; padding:3px 8px; background: rgba(0,0,0,.12); border-radius:999px; display:inline-block; vertical-align:middle }

/* Обмеження довжини для призів всередині капсул (однорядковий еліпсис) */
.chip-prize{ max-width:20ch; display:inline-block; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }

/* Приховувати блок з призами, якщо відключено */
#prizesWrap[hidden]{ display:none }
/* Перемикач використання призів (гарний toggle) */
.prize-toggle{ display:inline-flex; align-items:center; gap:10px; font-weight:700; cursor:pointer; user-select:none }
.prize-toggle input{ display:none }
.prize-toggle .toggle-ui{ width:48px; height:28px; background:rgba(255,255,255,.06); border-radius:999px; position:relative; border:1px solid var(--border); transition: background .18s ease, transform .12s ease; display:inline-flex; align-items:center }
.prize-toggle .toggle-ui .knob{ position:relative; left:6px; width:18px; height:18px; background:var(--panel); border-radius:50%; transition: transform .18s ease, background .18s; box-shadow: 0 6px 16px rgba(2,10,30,.16); transform: translateX(0) }
.prize-toggle input:checked + .toggle-ui{ background: linear-gradient(90deg,var(--accent1),var(--accent2)); border-color: transparent }
.prize-toggle input:checked + .toggle-ui .knob{ transform: translateX(18px); background:#fff }
.prize-toggle .label{ font-size:13px; color:var(--muted); display:inline-block; line-height:1 }

/* Відступ знизу для підпису над textarea імен */
.names-label{ display:block; margin-bottom:8px }

/* Відступ для підпису блока призів */
.prizes-label{ display:block; margin-bottom:8px }

.chip:nth-child(2){ animation-delay:.05s }
.chip:nth-child(3){ animation-delay:.1s }
@keyframes pop{
  from{ transform: translateY(8px) scale(.98); opacity:0 }
  to{ transform: translateY(0) scale(1); opacity:1 }
}

.history{ margin-top:10px }
.history-list{ margin:8px 0 0; padding-left:18px; opacity:.95 }
.history-list li{ margin: 4px 0 }

.footer{ text-align:center; opacity:.75; font-size:12px; margin-top: 4px }

.burst{ position:fixed; inset:0; pointer-events:none; overflow:hidden; }
.dot{
  position:absolute; width:10px; height:10px; border-radius:50%;
  opacity:.9; animation: fly 1200ms ease-out forwards;
}
@keyframes fly{
  0%{ transform:translate(var(--x,0), var(--y,0)) scale(0); opacity:1 }
  100%{ transform:translate(var(--tx,0), var(--ty,0)) scale(1.1); opacity:0 }
}

/* Зменшення руху для тих, кому потрібно */
@media (prefers-reduced-motion: reduce){
  .slot.spin span{ animation:none }
  .chip{ animation:none; opacity:1; transform:none }
  .btn .ripple{ display:none }
}

/* =========================
   Адаптивні правки
   - Гарантуємо, що модальне вікно вміщується на малих екранах
   - Робимо .modal-content прокручуваним і зручною прокруткою для сенсорних екранів
   - На малих екранах складаємо тіло модалки вертикально
   - Покращуємо відображення слотів і чіпів на вузьких екранах
   ========================= */

.modal-content {
  /* Дозволити прокрутку вмісту модалки, коли висоти вікна недостатньо */
  max-height: calc(100vh - 48px);
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}

/* Маленькі екрани: вертикальне розташування контенту модалки і менші відступи */
@media (max-width: 720px) {
  .modal { align-items: flex-start; padding-top: 12px; }
  .modal-content { width: calc(100% - 20px); max-width: 100%; margin: 10px; border-radius: 12px; }
  .modal-body { flex-direction: column; gap: 12px; padding: 12px; }
  .modal-robot { flex: 0 0 auto; display:flex; align-items:center; justify-content:center }
  .modal-robot img { width: 96px; height: auto; max-width: 30%; }
  .modal-results { width: 100%; }
  .modal-winners { max-height: calc(100vh - 220px); overflow: auto; padding-right: 6px; }
  .modal-content::before{ display:none }
  .winner-card{ flex-wrap:wrap; gap:8px }
  .winner-prize{ margin-left:0; margin-top:8px }
}

/* Дуже вузькі екрани: слоти в одну колонку та менші чіпи */
@media (max-width: 520px) {
  .slots { grid-template-columns: 1fr; gap:10px }
  .slot { height: auto; min-height:56px; padding:10px; font-size:14px }
  .slot.multiple{ height:auto }
  .chip{ max-width:100%; font-size:14px }
  .chip-prize{ max-width:16ch }
  .modal-robot img{ width:84px; max-width:24% }
  .modal-winners{ max-height: calc(100vh - 200px) }
}

/* Зменшення великих зображень/відступів коли висота вьюпорту обмежена */
@media (max-height: 520px) {
  .modal-body{ gap:8px; padding:10px }
  .modal-robot img{ width:72px }
  .modal-winners{ max-height: calc(100vh - 160px) }
}

/* Доступність: повага до prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
  .modal-body, .modal-winners, .slots { scroll-behavior: auto }
}

/* Невелика підправка: щоб toast/ефекти не перекривали важливі елементи на дуже маленьких екранах */
@media (max-width:420px){
  .toast{ font-size:13px; padding:8px 10px }
}